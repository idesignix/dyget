<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ØªØ­ÙˆÙŠÙ„ Dailymotion Ù…Ø¨Ø§Ø´Ø±</title>
    <script>
        // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ø¹Ø±Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·
        function getVideoId() {
            const urlParams = new URLSearchParams(window.location.search);
            let videoId = urlParams.get('id') || urlParams.get('video');
            
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø¹Ø±Ù ÙÙŠ Ù…Ø³Ø§Ø± URL (Ù…Ø«Ù„ /x98ox48)
            if (!videoId) {
                const path = window.location.pathname;
                const match = path.match(/\/([a-zA-Z0-9]+)$/);
                if (match) videoId = match[1];
            }
            
            return videoId;
        }

        // Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
        async function redirectToM3U8() {
            const videoId = getVideoId();
            
            // Ø¥Ø°Ø§ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¹Ø±Ù ÙÙŠØ¯ÙŠÙˆØŒ Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø¨Ø³ÙŠØ·Ø©
            if (!videoId) {
                document.body.innerHTML = `
                    <div style="font-family: Arial; padding: 50px; text-align: center;">
                        <h2>ğŸ¬ Dailymotion Direct Redirector</h2>
                        <p>Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø´ÙƒÙ„:</p>
                        <code style="background: #f0f0f0; padding: 10px; display: block; margin: 20px;">
                            https://idesignix.github.io/dyget/?id=x98ox48
                        </code>
                        <p>Ø£Ùˆ</p>
                        <code style="background: #f0f0f0; padding: 10px; display: block; margin: 20px;">
                            https://idesignix.github.io/dyget/x98ox48
                        </code>
                    </div>
                `;
                return;
            }

            try {
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¬Ù„Ø¨ Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ù† Ø¹Ø¯Ø© APIs
                const proxies = [
                    `https://api.allorigins.win/raw?url=${encodeURIComponent(`https://geo.dailymotion.com/video/${videoId}.json?legacy=true&embedder=https://www.dailymotion.com/video/${videoId}`)}`,
                    `https://corsproxy.io/?${encodeURIComponent(`https://geo.dailymotion.com/video/${videoId}.json?legacy=true&embedder=https://www.dailymotion.com/video/${videoId}`)}`,
                    `https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(`https://geo.dailymotion.com/video/${videoId}.json?legacy=true&embedder=https://www.dailymotion.com/video/${videoId}`)}`
                ];

                let m3u8Url = null;
                
                // ØªØ¬Ø±Ø¨Ø© ÙƒÙ„ proxy
                for (const proxy of proxies) {
                    try {
                        const response = await fetch(proxy);
                        const data = await response.json();
                        
                        // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø±Ø§Ø¨Ø·
                        if (data.qualities?.auto?.[0]?.url) {
                            m3u8Url = data.qualities.auto[0].url.replace(/\\\//g, '/');
                            break;
                        } else if (data.streams?.auto?.[0]?.url) {
                            m3u8Url = data.streams.auto[0].url.replace(/\\\//g, '/');
                            break;
                        }
                    } catch (e) {
                        console.log('Proxy failed:', e);
                    }
                }

                // Ø¥Ø°Ø§ ÙˆØ¬Ø¯Ù†Ø§ Ø§Ù„Ø±Ø§Ø¨Ø·ØŒ Ù†Ø­ÙˆÙ„ Ù…Ø¨Ø§Ø´Ø±Ø©
                if (m3u8Url) {
                    window.location.replace(m3u8Url);
                } else {
                    throw new Error('Ù„Ù… Ù†ØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ');
                }

            } catch (error) {
                // ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£ØŒ Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø¨Ø³ÙŠØ·Ø©
                document.body.innerHTML = `
                    <div style="font-family: Arial; padding: 50px; text-align: center;">
                        <h2>âŒ Ø®Ø·Ø£</h2>
                        <p>${error.message}</p>
                        <p>ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ù…Ø¹Ø±Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ: <strong>${videoId}</strong></p>
                        <button onclick="location.reload()">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©</button>
                    </div>
                `;
            }
        }

        // ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.onload = redirectToM3U8;
    </script>
</head>
<body style="margin:0; padding:20px; font-family:Arial; text-align:center;">
    <div style="margin-top:50px;">
        <h2>â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ø±Ø§Ø¨Ø· m3u8...</h2>
        <p>Ø³ÙŠØªÙ… ØªØ­ÙˆÙŠÙ„Ùƒ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø®Ù„Ø§Ù„ Ù„Ø­Ø¸Ø§Øª</p>
    </div>
</body>
</html>
